# FreshFinder frontend

Fresh Finderは、AIを使用して食品を分析し、ユーザーの好みに基づいて推奨を提供するNext.jsアプリケーションです。このアプリは、野菜や肉製品の画像をキャプチャし、最も新鮮で適したアイテムの推奨を受け取ることができます。

このソリューションは、画像処理、ユーザー入力、およびAI分析を組み合わせて、高品質な農産物や肉製品を求める消費者のショッピング体験を向上させます。最新のウェブ技術と人工知能を活用することで、食品を選ぶ際の意思決定プロセスを簡素化することを目指しています。

Fresh Finderの主な機能は以下の通りです：

- 効率的な処理のための画像キャプチャと圧縮
- 製品タイプの選択（野菜または肉）
- 希望する製品特性のユーザー入力
- AI搭載の画像分析と推奨生成
- 様々なデバイスでシームレスに使用できるレスポンシブデザイン

## リポジトリ構造

```
.
├── Dockerfile
├── src
│   └── app
│       ├── context.tsx
│       ├── globals.css
│       ├── layout.tsx
│       ├── page.tsx
│       ├── page2
│       │   └── page.tsx
│       ├── page3
│       │   └── page.tsx
│       └── page4
│           └── page.tsx
├── next.config.ts
├── package.json
├── tailwind.config.ts
└── tsconfig.json
```

主なファイル：

- `src/app/page.tsx`: アプリケーションのエントリーポイント（ランディングページ）
- `src/app/page2/page.tsx`: 画像キャプチャ機能
- `src/app/page3/page.tsx`: 製品タイプの選択と分析リクエスト
- `src/app/page4/page.tsx`: 分析結果の表示
- `src/app/layout.tsx`: メインレイアウトコンポーネントとコンテキストプロバイダー
- `src/app/context.tsx`: FreshFinderの状態管理用コンテキスト
- `next.config.ts`: Next.jsの設定
- `tailwind.config.ts`: Tailwind CSSの設定
- `tsconfig.json`: TypeScriptの設定
- `Dockerfile`: コンテナ化のためのマルチステージビルドプロセス

## 使用方法

### インストール

前提条件：

- Node.js v22.13.1以上
- npm v10.0.0以上

手順：

1. リポジトリをクローンします:

   ```
   git clone <repository-url>
   cd <repository-directory>/frontend
   ```

2. npmを使用して依存関係をインストールします：

   ```
   npm install
   ```

### アプリケーションの実行

開発サーバーを実行するには：

```
npm run dev
```

ブラウザで[http://localhost:3000](http://localhost:3000)を開いてアプリケーションを確認します。

### 一般的な使用例

1. 食物画像のキャプチャ：
   - 2ページ目に移動
   - 「撮影する」ボタンをクリック
   - デバイスを使用して画像を選択または撮影
      - デスクトップの場合：ローカルに保存した画像を選択（`../sample_images`にサンプル画像があります）
      - スマートフォンの場合：カメラで画像を撮影

2. 食物の分析：
   - 3ページ目で食物タイプ（野菜または肉）を選択
   - 希望する食物情報を入力（例：「鮮度が高い」）
   - 「解析開始」ボタンをクリック

3. 分析結果の表示：
   - 4ページ目で分析結果画像を表示
   - 「完了」ボタンをクリックしてホームページに戻る

### 設定

アプリケーションは環境変数を使用して設定します。ルートディレクトリに`.env.local`ファイルを作成し、以下の内容を追加します：

```
NEXT_PUBLIC_API_BASE_URL=http://your-api-url
```

`http://your-api-url`をバックエンドAPIの実際のURLに置き換えます。

`NEXT_PUBLIC_API_BASE_URL`が未設定の場合、`http://localhost:8000`がデフォルト値として設定されます。

### トラブルシューティング

一般的な問題：画像のアップロードが失敗する

- 問題：選択した画像が大きすぎるか、サポートされていない形式である
- 解決策：画像が一般的な形式（JPEG、PNG）であり、5MB未満であることを確認
- デバッグ：ブラウザのコンソールでファイルアップロードに関連するエラーメッセージを確認

一般的な問題：分析リクエストが失敗する

- 問題：APIサーバーが応答しないか、エラーを返す
- 解決策：`.env.local`ファイルに`NEXT_PUBLIC_API_BASE_URL`が正しく設定されていることを確認
- デバッグ：`src/app/page3/page.tsx`の`handleAnalysis`関数に`console.log`ステートメントを追加して詳細なログを有効にする

パフォーマンス最適化：

- `/genai-image-analysis` APIエンドポイントの応答時間を監視
- ブラウザの開発者ツールのネットワークタブを使用してリクエスト/レスポンスサイクルをプロファイル
- 頻繁に分析される製品のキャッシュメカニズムを実装してAPIコールを削減

## データフロー

Fresh Finderアプリケーションは、ユーザー入力を処理し、製品推奨を生成するための線形フローに従います：

1. ユーザーが食品の画像をキャプチャまたは選択（page2）
2. 画像は効率的な処理のために最大幅800pxに圧縮
3. ユーザーが製品タイプを選択し、希望する情報を入力（page3）
4. アプリケーションは画像、製品タイプ、およびユーザーの好みを含むPOSTリクエストを`/genai-image-analysis`エンドポイントに送信
5. バックエンドAPIがリクエストを処理し、分析結果画像を返す
6. アプリケーションがユーザーに結果画像を表示（page4）

```
[ユーザー入力] -> [画像キャプチャ] -> [圧縮] -> [製品情報] -> [APIリクエスト] -> [AI分析] -> [結果表示]
```

注：バックエンドAPIが予想されるリクエスト量を処理できることを確認し、過負荷を防ぐために適切なレート制限を実装してください。
